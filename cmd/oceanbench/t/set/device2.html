<!doctype html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <link href="http://localhost:5173/src/main.css" rel="stylesheet" type="text/css" />
    <title>Devices</title>
    <script type="module" src="http://localhost:5173/src/web-components/header-group.ts"></script>
    <script type="module" src="http://localhost:5173/src/lit/device-settings.js"></script>
    <script type="text/javascript" src="http://localhost:5173/src/main.js"></script>
  </head>
  <body>
    <header-group id="header" class="header" version="{{.Version}}" {{if .Profile}}auth="true" {{end}}>
      <nav-menu id="nav-menu" slot="nav-menu">
        {{range .Pages -}}
        <li data-perm="{{.Perm}}" class="indent-{{ .Level }}">
          <a {{if .URL}}href="{{.URL}}" {{end}}{{if .Selected}} class="selected" {{end}}>{{.Name}}</a>
        </li>
        {{- end}}
      </nav-menu>
      <site-menu id="sitemenu" {{if .Profile}}selected-data="{{.Profile.Data}}" {{end}} slot="site-menu">
        {{range .Users -}}
        <option style="display: none" slot="{{.PermissionText}}" value="{{.Skey}}"></option>
        {{- end}}
      </site-menu>
    </header-group>
    <section id="main" class="main">
      <div popover id="calibration-popover">
        <div class="bg-white rounded w-50 mx-auto p-5 mt-5">
          <div class="d-flex justify-content-between align-items-center">
            <h2>Calibrate</h2>
            <button class="btn btn-close" popovertarget="calibration-popover" popovertargetaction="hide"></button>
          </div>
          <hr />
          <form class="d-flex flex-column gap-2" method="post" action="/set/devices/edit/calibrate">
            <input name="ma" hidden value="{{.Device.MAC}}" />
            <div class="row d-flex gx-1 text-center">
              <div class="col-3 text-end pt-2"></div>
              <div class="col-1">Battery</div>
              <div class="col-1">Network</div>
              <div class="col-1">Power 1</div>
              <div class="col-1">Power 2</div>
              <div class="col-1">Power 3</div>
            </div>
            <div class="row d-flex gx-1 align-items-center">
              <label class="col-3 text-end pt-2">Measured Voltage:</label>
              <div class="col-1">
                <input class="form-control voltage" type="input" name="vb" />
              </div>
              <div class="col-1">
                <input class="form-control voltage" type="input" name="vnw" />
              </div>
              <div class="col-1">
                <input class="form-control voltage" type="input" name="vp1" />
              </div>
              <div class="col-1">
                <input class="form-control voltage" type="input" name="vp2" />
              </div>
              <div class="col-1">
                <input class="form-control voltage" type="input" name="vp3" />
              </div>
              <label for="lock-voltages" style="cursor: pointer" class="col-1 ps-4">
                <input class="d-none" type="checkbox" id="lock-voltages" checked />
                <span id="lock-icon" class="bi bi-unlock-fill"></span>
              </label>
            </div>
            <div class="row d-flex gx-1">
              <label class="col-sm-2 col-md-3 col-1 text-end pt-2">Alarm Voltage:</label>
              <div class="col-sm-10 col-md-6 col-12">
                <input class="form-control" type="input" name="va" value="24.5" />
              </div>
            </div>
            <div class="row d-flex gx-1">
              <label class="col-sm-2 col-md-3 col-1 text-end pt-2">Alarm Recovery Voltage:</label>
              <div class="col-sm-10 col-md-6 col-12">
                <input class="form-control" type="input" name="vr" value="25" />
              </div>
            </div>
            <div class="row d-flex gx-1 align-items-center">
              <div class="col-3 text-end pt-2"></div>
              <input type="submit" class="btn btn-primary w-50" value="Calibrate Now" />
            </div>
          </form>
          <small>NOTE: Sensors will only be calibrated whilst reading non-zero values</small>
        </div>
      </div>
      {{if .Msg}}
      <div class="red">{{.Msg}}</div>
      <br />
      {{end}}
      <h1 class="container-md">Devices</h1>
      <div class="border rounded p-4 container-md bg-white">
        <device-settings></device-settings>
      </div>
  </body>
</html>
